function cov_83lo2ois1(){var path="/home/raposo/projects/testesnodejs/05-tdd-project/src/service/carService.js";var hash="fc62eeff443d448e6ab61d847e3599615a6ef0c9";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/raposo/projects/testesnodejs/05-tdd-project/src/service/carService.js",statementMap:{"0":{start:{line:1,column:23},end:{line:1,column:69}},"1":{start:{line:2,column:12},end:{line:2,column:40}},"2":{start:{line:3,column:20},end:{line:3,column:56}},"3":{start:{line:7,column:8},end:{line:7,column:63}},"4":{start:{line:8,column:8},end:{line:8,column:50}},"5":{start:{line:9,column:8},end:{line:12,column:10}},"6":{start:{line:16,column:27},end:{line:16,column:38}},"7":{start:{line:17,column:8},end:{line:19,column:9}},"8":{start:{line:22,column:31},end:{line:22,column:82}},"9":{start:{line:23,column:22},end:{line:23,column:56}},"10":{start:{line:25,column:8},end:{line:25,column:20}},"11":{start:{line:28,column:22},end:{line:28,column:55}},"12":{start:{line:29,column:20},end:{line:29,column:56}},"13":{start:{line:31,column:8},end:{line:31,column:18}},"14":{start:{line:35,column:24},end:{line:35,column:32}},"15":{start:{line:36,column:22},end:{line:36,column:39}},"16":{start:{line:37,column:30},end:{line:38,column:58}},"17":{start:{line:38,column:25},end:{line:38,column:57}},"18":{start:{line:40,column:28},end:{line:40,column:58}},"19":{start:{line:41,column:31},end:{line:41,column:69}},"20":{start:{line:43,column:8},end:{line:43,column:29}},"21":{start:{line:49,column:20},end:{line:49,column:59}},"22":{start:{line:50,column:27},end:{line:50,column:94}},"23":{start:{line:52,column:22},end:{line:52,column:32}},"24":{start:{line:53,column:8},end:{line:53,column:53}},"25":{start:{line:54,column:24},end:{line:54,column:73}},"26":{start:{line:55,column:24},end:{line:55,column:66}},"27":{start:{line:57,column:28},end:{line:62,column:10}},"28":{start:{line:64,column:8},end:{line:64,column:27}},"29":{start:{line:68,column:0},end:{line:68,column:27}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:6,column:4},end:{line:6,column:5}},loc:{start:{line:6,column:26},end:{line:13,column:5}},line:6},"1":{name:"(anonymous_1)",decl:{start:{line:15,column:4},end:{line:15,column:5}},loc:{start:{line:15,column:37},end:{line:20,column:5}},line:15},"2":{name:"(anonymous_2)",decl:{start:{line:21,column:4},end:{line:21,column:5}},loc:{start:{line:21,column:33},end:{line:26,column:5}},line:21},"3":{name:"(anonymous_3)",decl:{start:{line:27,column:4},end:{line:27,column:5}},loc:{start:{line:27,column:39},end:{line:32,column:5}},line:27},"4":{name:"(anonymous_4)",decl:{start:{line:34,column:4},end:{line:34,column:5}},loc:{start:{line:34,column:61},end:{line:44,column:5}},line:34},"5":{name:"(anonymous_5)",decl:{start:{line:38,column:18},end:{line:38,column:19}},loc:{start:{line:38,column:25},end:{line:38,column:57}},line:38},"6":{name:"(anonymous_6)",decl:{start:{line:46,column:4},end:{line:46,column:5}},loc:{start:{line:48,column:6},end:{line:65,column:5}},line:48}},branchMap:{"0":{loc:{start:{line:38,column:25},end:{line:38,column:57}},type:"binary-expr",locations:[{start:{line:38,column:25},end:{line:38,column:40}},{start:{line:38,column:44},end:{line:38,column:57}}],line:38}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"fc62eeff443d448e6ab61d847e3599615a6ef0c9"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_83lo2ois1=function(){return actualCoverage;};}return actualCoverage;}cov_83lo2ois1();const BaseRepository=(cov_83lo2ois1().s[0]++,require('./../repository/base/baseRepository'));const Tax=(cov_83lo2ois1().s[1]++,require('./../entities/tax'));const Transaction=(cov_83lo2ois1().s[2]++,require('./../entities/transaction'));class CarService{constructor({cars}){cov_83lo2ois1().f[0]++;cov_83lo2ois1().s[3]++;this.carRepository=new BaseRepository({file:cars});cov_83lo2ois1().s[4]++;this.taxesBasedOnAge=Tax.taxesBasedOnAge;cov_83lo2ois1().s[5]++;this.currencyFormat=new Intl.NumberFormat('pt-br',{style:'currency',currency:'BRL'});}getRandomPositionFromArray(list){cov_83lo2ois1().f[1]++;const listLength=(cov_83lo2ois1().s[6]++,list.length);cov_83lo2ois1().s[7]++;return Math.floor(Math.random()*listLength);}chooseRandomCar(carCategory){cov_83lo2ois1().f[2]++;const randomCarIndex=(cov_83lo2ois1().s[8]++,this.getRandomPositionFromArray(carCategory.carIds));const carId=(cov_83lo2ois1().s[9]++,carCategory.carIds[randomCarIndex]);cov_83lo2ois1().s[10]++;return carId;}async getAvailableCar(carCategory){cov_83lo2ois1().f[3]++;const carId=(cov_83lo2ois1().s[11]++,this.chooseRandomCar(carCategory));const car=(cov_83lo2ois1().s[12]++,await this.carRepository.find(carId));cov_83lo2ois1().s[13]++;return car;}calculateFinalPrice(customer,carCategory,numberOfDays){cov_83lo2ois1().f[4]++;const{age}=(cov_83lo2ois1().s[14]++,customer);const price=(cov_83lo2ois1().s[15]++,carCategory.price);const{then:tax}=(cov_83lo2ois1().s[16]++,this.taxesBasedOnAge.find(tax=>{cov_83lo2ois1().f[5]++;cov_83lo2ois1().s[17]++;return(cov_83lo2ois1().b[0][0]++,age>=tax.from)&&(cov_83lo2ois1().b[0][1]++,age<=tax.to);}));const finalPrice=(cov_83lo2ois1().s[18]++,tax*price*numberOfDays);const formattedPrice=(cov_83lo2ois1().s[19]++,this.currencyFormat.format(finalPrice));cov_83lo2ois1().s[20]++;return formattedPrice;}async rent(customer,carCategory,numberOfDays){cov_83lo2ois1().f[6]++;const car=(cov_83lo2ois1().s[21]++,await this.getAvailableCar(carCategory));const finalPrice=(cov_83lo2ois1().s[22]++,await this.calculateFinalPrice(customer,carCategory,numberOfDays));const today=(cov_83lo2ois1().s[23]++,new Date());cov_83lo2ois1().s[24]++;today.setDate(today.getDate()+numberOfDays);const options=(cov_83lo2ois1().s[25]++,{year:"numeric",month:"long",day:"numeric"});const dueDate=(cov_83lo2ois1().s[26]++,today.toLocaleDateString("pt-br",options));const transaction=(cov_83lo2ois1().s[27]++,new Transaction({customer,dueDate,car,amount:finalPrice}));cov_83lo2ois1().s[28]++;return transaction;}}cov_83lo2ois1().s[29]++;module.exports=CarService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhclNlcnZpY2UuanMiXSwibmFtZXMiOlsiQmFzZVJlcG9zaXRvcnkiLCJyZXF1aXJlIiwiVGF4IiwiVHJhbnNhY3Rpb24iLCJDYXJTZXJ2aWNlIiwiY29uc3RydWN0b3IiLCJjYXJzIiwiY2FyUmVwb3NpdG9yeSIsImZpbGUiLCJ0YXhlc0Jhc2VkT25BZ2UiLCJjdXJyZW5jeUZvcm1hdCIsIkludGwiLCJOdW1iZXJGb3JtYXQiLCJzdHlsZSIsImN1cnJlbmN5IiwiZ2V0UmFuZG9tUG9zaXRpb25Gcm9tQXJyYXkiLCJsaXN0IiwibGlzdExlbmd0aCIsImxlbmd0aCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImNob29zZVJhbmRvbUNhciIsImNhckNhdGVnb3J5IiwicmFuZG9tQ2FySW5kZXgiLCJjYXJJZHMiLCJjYXJJZCIsImdldEF2YWlsYWJsZUNhciIsImNhciIsImZpbmQiLCJjYWxjdWxhdGVGaW5hbFByaWNlIiwiY3VzdG9tZXIiLCJudW1iZXJPZkRheXMiLCJhZ2UiLCJwcmljZSIsInRoZW4iLCJ0YXgiLCJmcm9tIiwidG8iLCJmaW5hbFByaWNlIiwiZm9ybWF0dGVkUHJpY2UiLCJmb3JtYXQiLCJyZW50IiwidG9kYXkiLCJEYXRlIiwic2V0RGF0ZSIsImdldERhdGUiLCJvcHRpb25zIiwieWVhciIsIm1vbnRoIiwiZGF5IiwiZHVlRGF0ZSIsInRvTG9jYWxlRGF0ZVN0cmluZyIsInRyYW5zYWN0aW9uIiwiYW1vdW50IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IjJzSEFlWTt5RkFmWixLQUFNQSxDQUFBQSxjQUFjLHlCQUFHQyxPQUFPLENBQUMscUNBQUQsQ0FBVixDQUFwQixDQUNBLEtBQU1DLENBQUFBLEdBQUcseUJBQUdELE9BQU8sQ0FBQyxtQkFBRCxDQUFWLENBQVQsQ0FDQSxLQUFNRSxDQUFBQSxXQUFXLHlCQUFHRixPQUFPLENBQUMsMkJBQUQsQ0FBVixDQUFqQixDQUVBLEtBQU1HLENBQUFBLFVBQVcsQ0FDYkMsV0FB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MUIsQ0FBa0NDLEdBQUcsQ0FBRSxTQUF2QyxDQUFILENBQWIsQ0FDQSxLQUFNQyxDQUFBQSxPQUFPLDBCQUFHUixLQUFLLENBQUNTLGtCQUFOLENBQXlCLE9BQXpCLENBQWtDTCxPQUFsQyxDQUFILENBQWIsQ0FFQSxLQUFNTSxDQUFBQSxXQUFXLDBCQUFHLEdBQUlsRCxDQUFBQSxXQUFKLENBQWdCLENBQ2hDNEIsUUFEZ0MsQ0FFaENvQixPQUZnQyxDQUdoQ3ZCLEdBSGdDLENBSWhDMEIsTUFBTSxDQUFFZixVQUp3QixDQUFoQixDQUFILENBQWpCLENBVEYsd0JBZ0JFLE1BQU9jLENBQUFBLFdBQVAsQ0FDSCxDQTVEWSxDLHdCQStEakJFLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQnBELFVBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgQmFzZVJlcG9zaXRvcnkgPSByZXF1aXJlKCcuLy4uL3JlcG9zaXRvcnkvYmFzZS9iYXNlUmVwb3NpdG9yeScpXG5jb25zdCBUYXggPSByZXF1aXJlKCcuLy4uL2VudGl0aWVzL3RheCcpXG5jb25zdCBUcmFuc2FjdGlvbiA9IHJlcXVpcmUoJy4vLi4vZW50aXRpZXMvdHJhbnNhY3Rpb24nKVxuXG5jbGFzcyBDYXJTZXJ2aWNlIHtcbiAgICBjb25zdHJ1Y3Rvcih7IGNhcnMgfSkge1xuICAgICAgICB0aGlzLmNhclJlcG9zaXRvcnkgPSBuZXcgQmFzZVJlcG9zaXRvcnkoeyBmaWxlOiBjYXJzIH0pXG4gICAgICAgIHRoaXMudGF4ZXNCYXNlZE9uQWdlID0gVGF4LnRheGVzQmFzZWRPbkFnZVxuICAgICAgICB0aGlzLmN1cnJlbmN5Rm9ybWF0ID0gbmV3IEludGwuTnVtYmVyRm9ybWF0KCdwdC1icicsIHtcbiAgICAgICAgICAgIHN0eWxlOiAnY3VycmVuY3knLFxuICAgICAgICAgICAgY3VycmVuY3k6ICdCUkwnXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZ2V0UmFuZG9tUG9zaXRpb25Gcm9tQXJyYXkobGlzdCkge1xuICAgICAgICBjb25zdCBsaXN0TGVuZ3RoID0gbGlzdC5sZW5ndGhcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoXG4gICAgICAgICAgICBNYXRoLnJhbmRvbSgpICogKGxpc3RMZW5ndGgpXG4gICAgICAgIClcbiAgICB9XG4gICAgY2hvb3NlUmFuZG9tQ2FyKGNhckNhdGVnb3J5KSB7XG4gICAgICAgIGNvbnN0IHJhbmRvbUNhckluZGV4ID0gdGhpcy5nZXRSYW5kb21Qb3NpdGlvbkZyb21BcnJheShjYXJDYXRlZ29yeS5jYXJJZHMpXG4gICAgICAgIGNvbnN0IGNhcklkID0gY2FyQ2F0ZWdvcnkuY2FySWRzW3JhbmRvbUNhckluZGV4XVxuXG4gICAgICAgIHJldHVybiBjYXJJZFxuICAgIH1cbiAgICBhc3luYyBnZXRBdmFpbGFibGVDYXIoY2FyQ2F0ZWdvcnkpIHtcbiAgICAgICAgY29uc3QgY2FySWQgPSB0aGlzLmNob29zZVJhbmRvbUNhcihjYXJDYXRlZ29yeSlcbiAgICAgICAgY29uc3QgY2FyID0gYXdhaXQgdGhpcy5jYXJSZXBvc2l0b3J5LmZpbmQoY2FySWQpXG5cbiAgICAgICAgcmV0dXJuIGNhclxuICAgIH1cblxuICAgIGNhbGN1bGF0ZUZpbmFsUHJpY2UoY3VzdG9tZXIsIGNhckNhdGVnb3J5LCBudW1iZXJPZkRheXMpIHtcbiAgICAgICAgY29uc3QgeyBhZ2UgfSA9IGN1c3RvbWVyXG4gICAgICAgIGNvbnN0IHByaWNlID0gY2FyQ2F0ZWdvcnkucHJpY2UgXG4gICAgICAgIGNvbnN0IHsgdGhlbjogdGF4IH0gPSB0aGlzLnRheGVzQmFzZWRPbkFnZVxuICAgICAgICAgICAgLmZpbmQodGF4ID0+IGFnZSA+PSB0YXguZnJvbSAmJiBhZ2UgPD0gdGF4LnRvKVxuXG4gICAgICAgIGNvbnN0IGZpbmFsUHJpY2UgPSAoKHRheCAqIHByaWNlKSAqIChudW1iZXJPZkRheXMpKVxuICAgICAgICBjb25zdCBmb3JtYXR0ZWRQcmljZSA9IHRoaXMuY3VycmVuY3lGb3JtYXQuZm9ybWF0KGZpbmFsUHJpY2UpXG5cbiAgICAgICAgcmV0dXJuIGZvcm1hdHRlZFByaWNlXG4gICAgfVxuXG4gICAgYXN5bmMgcmVudChcbiAgICAgICAgY3VzdG9tZXIsIGNhckNhdGVnb3J5LCBudW1iZXJPZkRheXNcbiAgICApIHtcbiAgICAgICAgY29uc3QgY2FyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVDYXIoY2FyQ2F0ZWdvcnkpXG4gICAgICAgIGNvbnN0IGZpbmFsUHJpY2UgPSBhd2FpdCB0aGlzLmNhbGN1bGF0ZUZpbmFsUHJpY2UoY3VzdG9tZXIsIGNhckNhdGVnb3J5LCBudW1iZXJPZkRheXMpXG5cbiAgICAgICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpXG4gICAgICAgIHRvZGF5LnNldERhdGUodG9kYXkuZ2V0RGF0ZSgpICsgbnVtYmVyT2ZEYXlzKVxuICAgICAgICBjb25zdCBvcHRpb25zID0geyB5ZWFyOiBcIm51bWVyaWNcIiwgbW9udGg6IFwibG9uZ1wiLCBkYXk6IFwibnVtZXJpY1wifVxuICAgICAgICBjb25zdCBkdWVEYXRlID0gdG9kYXkudG9Mb2NhbGVEYXRlU3RyaW5nKFwicHQtYnJcIiwgb3B0aW9ucylcblxuICAgICAgICBjb25zdCB0cmFuc2FjdGlvbiA9IG5ldyBUcmFuc2FjdGlvbih7XG4gICAgICAgICAgICBjdXN0b21lcixcbiAgICAgICAgICAgIGR1ZURhdGUsXG4gICAgICAgICAgICBjYXIsXG4gICAgICAgICAgICBhbW91bnQ6IGZpbmFsUHJpY2VcbiAgICAgICAgfSlcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0cmFuc2FjdGlvbjtcbiAgICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gQ2FyU2VydmljZSJdfQ==